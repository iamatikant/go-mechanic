{"ast":null,"code":"import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { forwardRef, useState, useEffect, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport Text from '../Text';\nimport { useConfiguration, useConsolidatedRef, useI18n, useLiveLog } from '../../hooks';\nimport Flex from '../Flex';\nimport Bar from './Bar';\nimport Ellipsis from './Ellipsis';\nimport Ring from './Ring';\nimport { StyledMessage, StyledProgress, StyledProgressBackdrop } from './Progress.styles';\nconst variantMap = {\n  ring: Ring,\n  bar: Bar,\n  ellipsis: Ellipsis\n};\nconst delayDuration = 100;\nconst minVisibleDuration = 1000;\nconst Progress = forwardRef((_ref, ref) => {\n  let {\n    variant = 'ring',\n    placement = 'global',\n    visible: visibleProp = true,\n    focusOnVisible = false,\n    delay = false,\n    onTransitionEndIn,\n    onTransitionEndOut,\n    value,\n    message,\n    liveConfig,\n    ...restProps\n  } = _ref;\n  const t = useI18n();\n  const {\n    portalTarget\n  } = useConfiguration();\n  const {\n    announcePolite\n  } = useLiveLog();\n  const progressEl = useConsolidatedRef(ref);\n  // Rendering states. Both are needed due to Backdrop's transition phase where isVisibleState is false but nullRender is true until onAfterTransitionOut.\n  const [isVisibleState, setIsVisibleState] = useState(delay ? false : visibleProp);\n  const [nullRender, setNullRender] = useState(!isVisibleState);\n  // Refs for timestamps and timeout ids.\n  const timeBeforeVisibleRender = useRef();\n  const timeAfterVisibleRender = useRef();\n  const delayTimer = useRef();\n  const minVisibleTimer = useRef();\n  const hasBackdrop = placement === 'global' || placement === 'local';\n  const valString = typeof value === 'number' ? `${value}%` : undefined;\n  const label = message && valString ? `${message} - ${valString}` : message || valString;\n  const renderVisible = () => {\n    setIsVisibleState(true);\n    setNullRender(false);\n  };\n  const renderNotVisible = () => {\n    setIsVisibleState(false);\n    // With a transition, setNullRender needs to be called in Backdrop's onAfterTransitionOut.\n    if (!hasBackdrop) {\n      setNullRender(true);\n    }\n  };\n  // Handle render and visible state.\n  useEffect(() => {\n    if (visibleProp) {\n      // Capture a timestamp for additional timers.\n      timeBeforeVisibleRender.current = Date.now();\n      if (delay) {\n        delayTimer.current = window.setTimeout(renderVisible, delayDuration);\n      } else {\n        renderVisible();\n      }\n    } else if (\n    // A timer was started to render visible either avoid it or render null.\n    delayTimer.current !== undefined) {\n      // If a timeout has started to render visible, clear it.\n      clearTimeout(delayTimer.current);\n      // If the indicator has already rendered visible.\n      if (timeAfterVisibleRender.current !== undefined) {\n        const timeElapsedSinceLastVisibleRender = Date.now() - timeAfterVisibleRender.current;\n        // If the indicator has been visible for long enough we can remove it.\n        if (timeElapsedSinceLastVisibleRender >= minVisibleDuration) {\n          renderNotVisible();\n        } else {\n          // Hold off removing until we hit the minimum visible time.\n          minVisibleTimer.current = window.setTimeout(renderNotVisible, minVisibleDuration - timeElapsedSinceLastVisibleRender);\n        }\n      } else {\n        renderNotVisible();\n      }\n    } else {\n      renderNotVisible();\n    }\n  },\n  // visibleProp is the only triggerable dependency. Others values will be captured.\n  [visibleProp]);\n  // Live announcement\n  useEffect(() => {\n    if (liveConfig?.contextualLabel && isVisibleState) {\n      announcePolite({\n        message: `${liveConfig.contextualLabel}, ${label ?? t('loading')}`,\n        type: 'status'\n      });\n    }\n  },\n  // isVisibleState is the only triggerable dependency. Others values will be captured.\n  [isVisibleState]);\n  // Auto focusing and render timestamping.\n  useEffect(() => {\n    if (!nullRender && isVisibleState) {\n      // After a visible render set a timestamp for timers above.\n      timeAfterVisibleRender.current = Date.now();\n      if (focusOnVisible) progressEl.current?.focus();\n    }\n  },\n  // nullRender is the only triggerable dependency. Others values will be captured.\n  [nullRender]);\n  if (nullRender) return null;\n  const CompVariant = variantMap[variant];\n  let indicator = _jsx(CompVariant, {\n    \"aria-label\": typeof value !== 'number' ? label : t('loading'),\n    ...restProps,\n    placement: placement,\n    value: value,\n    \"aria-valuetext\": typeof value === 'number' ? label : undefined,\n    ref: progressEl,\n    tabIndex: -1\n  });\n  if (placement !== 'inline') {\n    indicator = _jsxs(Flex, {\n      container: {\n        direction: 'column',\n        alignItems: 'center',\n        gap: 0.5\n      },\n      as: StyledProgress,\n      placement: placement,\n      children: [indicator, message && _jsx(Text, {\n        as: StyledMessage,\n        variant: 'secondary',\n        \"aria-hidden\": 'true',\n        children: message\n      })]\n    });\n  }\n  const content = hasBackdrop ? _jsx(StyledProgressBackdrop, {\n    open: isVisibleState,\n    container: {\n      direction: 'column'\n    },\n    position: placement === 'global' ? 'fixed' : 'absolute',\n    variant: 'light',\n    alpha: 0.5,\n    onAfterTransitionIn: onTransitionEndIn,\n    onAfterTransitionOut: () => {\n      setNullRender(true);\n      onTransitionEndOut?.();\n    },\n    children: indicator\n  }) : indicator;\n  return placement === 'global' && portalTarget ? createPortal(content, portalTarget) : content;\n});\nexport default Progress;","map":{"version":3,"names":["forwardRef","useState","useEffect","useRef","createPortal","Text","useConfiguration","useConsolidatedRef","useI18n","useLiveLog","Flex","Bar","Ellipsis","Ring","StyledMessage","StyledProgress","StyledProgressBackdrop","variantMap","ring","bar","ellipsis","delayDuration","minVisibleDuration","Progress","_ref","ref","variant","placement","visible","visibleProp","focusOnVisible","delay","onTransitionEndIn","onTransitionEndOut","value","message","liveConfig","restProps","t","portalTarget","announcePolite","progressEl","isVisibleState","setIsVisibleState","nullRender","setNullRender","timeBeforeVisibleRender","timeAfterVisibleRender","delayTimer","minVisibleTimer","hasBackdrop","valString","undefined","label","renderVisible","renderNotVisible","current","Date","now","window","setTimeout","clearTimeout","timeElapsedSinceLastVisibleRender","contextualLabel","type","focus","CompVariant","indicator","_jsx","tabIndex","_jsxs","container","direction","alignItems","gap","as","children","content","open","position","alpha","onAfterTransitionIn","onAfterTransitionOut"],"sources":["/Users/dasp10/Documents/KT_project/go-mechanic/client/node_modules/@pega/cosmos-react-core/src/components/Progress/Progress.tsx"],"sourcesContent":["import { forwardRef, PropsWithoutRef, FC, useState, useEffect, useRef } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { ForwardProps } from '../../types';\nimport Text from '../Text';\nimport { useConfiguration, useConsolidatedRef, useI18n, useLiveLog } from '../../hooks';\nimport Flex from '../Flex';\n\nimport { ProgressProps } from './Progress.types';\nimport Bar from './Bar';\nimport Ellipsis from './Ellipsis';\nimport Ring from './Ring';\nimport { StyledMessage, StyledProgress, StyledProgressBackdrop } from './Progress.styles';\n\nconst variantMap = {\n  ring: Ring,\n  bar: Bar,\n  ellipsis: Ellipsis\n} as const;\n\nconst delayDuration = 100;\nconst minVisibleDuration = 1000;\n\nconst Progress: FC<ProgressProps & ForwardProps> = forwardRef(\n  (\n    {\n      variant = 'ring',\n      placement = 'global',\n      visible: visibleProp = true,\n      focusOnVisible = false,\n      delay = false,\n      onTransitionEndIn,\n      onTransitionEndOut,\n      value,\n      message,\n      liveConfig,\n      ...restProps\n    }: PropsWithoutRef<ProgressProps>,\n    ref: ProgressProps['ref']\n  ) => {\n    const t = useI18n();\n    const { portalTarget } = useConfiguration();\n    const { announcePolite } = useLiveLog();\n    const progressEl = useConsolidatedRef<HTMLDivElement>(ref);\n\n    // Rendering states. Both are needed due to Backdrop's transition phase where isVisibleState is false but nullRender is true until onAfterTransitionOut.\n    const [isVisibleState, setIsVisibleState] = useState(delay ? false : visibleProp);\n    const [nullRender, setNullRender] = useState(!isVisibleState);\n\n    // Refs for timestamps and timeout ids.\n    const timeBeforeVisibleRender = useRef<number>();\n    const timeAfterVisibleRender = useRef<number>();\n    const delayTimer = useRef<number>();\n    const minVisibleTimer = useRef<number>();\n\n    const hasBackdrop = placement === 'global' || placement === 'local';\n    const valString = typeof value === 'number' ? `${value}%` : undefined;\n    const label = message && valString ? `${message} - ${valString}` : message || valString;\n\n    const renderVisible = () => {\n      setIsVisibleState(true);\n      setNullRender(false);\n    };\n\n    const renderNotVisible = () => {\n      setIsVisibleState(false);\n      // With a transition, setNullRender needs to be called in Backdrop's onAfterTransitionOut.\n      if (!hasBackdrop) {\n        setNullRender(true);\n      }\n    };\n\n    // Handle render and visible state.\n    useEffect(\n      () => {\n        if (visibleProp) {\n          // Capture a timestamp for additional timers.\n          timeBeforeVisibleRender.current = Date.now();\n\n          if (delay) {\n            delayTimer.current = window.setTimeout(renderVisible, delayDuration);\n          } else {\n            renderVisible();\n          }\n        } else if (\n          // A timer was started to render visible either avoid it or render null.\n          delayTimer.current !== undefined\n        ) {\n          // If a timeout has started to render visible, clear it.\n          clearTimeout(delayTimer.current);\n\n          // If the indicator has already rendered visible.\n          if (timeAfterVisibleRender.current !== undefined) {\n            const timeElapsedSinceLastVisibleRender = Date.now() - timeAfterVisibleRender.current;\n\n            // If the indicator has been visible for long enough we can remove it.\n            if (timeElapsedSinceLastVisibleRender >= minVisibleDuration) {\n              renderNotVisible();\n            } else {\n              // Hold off removing until we hit the minimum visible time.\n              minVisibleTimer.current = window.setTimeout(\n                renderNotVisible,\n                minVisibleDuration - timeElapsedSinceLastVisibleRender\n              );\n            }\n          } else {\n            renderNotVisible();\n          }\n        } else {\n          renderNotVisible();\n        }\n      },\n      // visibleProp is the only triggerable dependency. Others values will be captured.\n      [visibleProp]\n    );\n\n    // Live announcement\n    useEffect(\n      () => {\n        if (liveConfig?.contextualLabel && isVisibleState) {\n          announcePolite({\n            message: `${liveConfig.contextualLabel}, ${label ?? t('loading')}`,\n            type: 'status'\n          });\n        }\n      },\n      // isVisibleState is the only triggerable dependency. Others values will be captured.\n      [isVisibleState]\n    );\n\n    // Auto focusing and render timestamping.\n    useEffect(\n      () => {\n        if (!nullRender && isVisibleState) {\n          // After a visible render set a timestamp for timers above.\n          timeAfterVisibleRender.current = Date.now();\n\n          if (focusOnVisible) progressEl.current?.focus();\n        }\n      },\n      // nullRender is the only triggerable dependency. Others values will be captured.\n      [nullRender]\n    );\n\n    if (nullRender) return null;\n\n    const CompVariant = variantMap[variant];\n\n    let indicator = (\n      <CompVariant\n        aria-label={typeof value !== 'number' ? label : t('loading')}\n        {...restProps}\n        placement={placement}\n        value={value}\n        aria-valuetext={typeof value === 'number' ? label : undefined}\n        ref={progressEl}\n        tabIndex={-1}\n      />\n    );\n\n    if (placement !== 'inline') {\n      indicator = (\n        <Flex\n          container={{ direction: 'column', alignItems: 'center', gap: 0.5 }}\n          as={StyledProgress}\n          placement={placement}\n        >\n          {indicator}\n          {message && (\n            <Text as={StyledMessage} variant='secondary' aria-hidden='true'>\n              {message}\n            </Text>\n          )}\n        </Flex>\n      );\n    }\n\n    const content = hasBackdrop ? (\n      <StyledProgressBackdrop\n        open={isVisibleState}\n        container={{ direction: 'column' }}\n        position={placement === 'global' ? 'fixed' : 'absolute'}\n        variant='light'\n        alpha={0.5}\n        onAfterTransitionIn={onTransitionEndIn}\n        onAfterTransitionOut={() => {\n          setNullRender(true);\n          onTransitionEndOut?.();\n        }}\n      >\n        {indicator}\n      </StyledProgressBackdrop>\n    ) : (\n      indicator\n    );\n\n    return placement === 'global' && portalTarget ? createPortal(content, portalTarget) : content;\n  }\n);\n\nexport default Progress;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}