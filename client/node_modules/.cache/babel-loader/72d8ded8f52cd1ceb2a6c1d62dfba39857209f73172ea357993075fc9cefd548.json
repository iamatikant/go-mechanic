{"ast":null,"code":"import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { forwardRef, useState, useCallback } from 'react';\nimport styled, { css } from 'styled-components';\nimport { defaultThemeProp } from '../../theme';\nimport { useConsolidatedRef, useUID, useFocusWithin, useDirection, useTestIds } from '../../hooks';\nimport Button, { StyledButton } from '../Button';\nimport Popover, { StyledPopover } from '../Popover';\nimport Menu from '../Menu';\nimport Icon, { registerIcon, StyledIcon } from '../Icon';\nimport * as arrowMicroDownIcon from '../Icon/icons/arrow-micro-down.icon';\nimport Text, { StyledText } from '../Text';\nimport Flex from '../Flex';\nimport { Count } from '../Badges';\nimport { getMenuButtonTestIds } from './MenuButton.test-ids';\nregisterIcon(arrowMicroDownIcon);\nconst StyledMenuButton = styled.button(_ref => {\n  let {\n    theme: {\n      base: {\n        spacing\n      }\n    }\n  } = _ref;\n  return css`\n      gap: ${spacing};\n      flex-shrink: 0;\n      white-space: nowrap;\n      max-width: 100%;\n\n      & + ${StyledPopover} + ${StyledButton} {\n        margin-inline-start: ${spacing};\n      }\n    `;\n});\nStyledMenuButton.defaultProps = defaultThemeProp;\nconst StyledMenuButtonChildren = styled.div(_ref2 => {\n  let {\n    theme\n  } = _ref2;\n  return css`\n    max-width: 100%;\n\n    ${StyledText} {\n      text-overflow: ellipsis;\n      overflow: hidden;\n    }\n\n    :not(${StyledText}) {\n      flex-shrink: 0;\n    }\n\n    ${StyledIcon}:last-child:not(:first-child) {\n      /* Offsets the flex gap to make the down arrow appear to trail the text. */\n      margin-inline-start: -${theme.base.spacing};\n    }\n  `;\n});\nconst StyledMenuButtonPopover = styled(Popover)`\n  min-width: 20ch;\n`;\nconst MenuButton = forwardRef((props, ref) => {\n  const uid = useUID();\n  const {\n    testId,\n    id = uid,\n    text,\n    menu,\n    popover,\n    onClick,\n    onKeyDown,\n    icon,\n    count,\n    iconOnly = false,\n    ...restProps\n  } = props;\n  const testIds = useTestIds(testId, getMenuButtonTestIds);\n  const [isOpen, setIsOpen] = useState(false);\n  const buttonRef = useConsolidatedRef(ref);\n  const popoverRef = useConsolidatedRef(popover?.ref);\n  const menuRef = useConsolidatedRef(menu?.ref);\n  // FIXME: Type assertion required for issue in useFocusWithin generic\n  useFocusWithin([popoverRef, buttonRef], useCallback(isFocused => {\n    if (!isFocused) setIsOpen(false);\n  }, []));\n  const {\n    rtl\n  } = useDirection();\n  return _jsxs(_Fragment, {\n    children: [_jsx(Button, {\n      \"data-testid\": testIds.root,\n      as: StyledMenuButton,\n      \"aria-label\": text,\n      ...restProps,\n      id: id,\n      ref: buttonRef,\n      \"aria-expanded\": isOpen,\n      \"aria-haspopup\": 'menu',\n      \"aria-controls\": `${id}-popover`,\n      label: iconOnly && !isOpen ? text : undefined,\n      onClick: e => {\n        // clickCount is 0 when triggered by keyboard.\n        const clickCount = e.detail;\n        // Close the menu if it is open and either:\n        //   It is a *mouse* click on the button.\n        //   Or, the menu mode is not multiselect.\n        if (isOpen && (clickCount > 0 || menu?.mode !== 'multi-select')) {\n          setIsOpen(false);\n        } else {\n          setIsOpen(true);\n        }\n        onClick?.(e);\n      },\n      onKeyDown: e => {\n        if (e.key === 'Escape') setIsOpen(false);\n        onKeyDown?.(e);\n      },\n      icon: iconOnly,\n      children: _jsxs(Flex, {\n        as: StyledMenuButtonChildren,\n        container: {\n          alignItems: 'center',\n          gap: 1\n        },\n        children: [icon && _jsx(Icon, {\n          name: icon\n        }), !iconOnly && _jsxs(_Fragment, {\n          children: [text && _jsx(Text, {\n            children: text\n          }), typeof count === 'number' && _jsx(Count, {\n            children: count\n          }), text && _jsx(Icon, {\n            name: 'arrow-micro-down'\n          })]\n        })]\n      })\n    }), _jsx(StyledMenuButtonPopover, {\n      placement: rtl ? 'bottom-end' : 'bottom-start',\n      hideOnTargetHidden: true,\n      ...popover,\n      id: `${id}-popover`,\n      show: !!menu && isOpen,\n      target: buttonRef.current,\n      ref: popoverRef,\n      children: menu && _jsx(Menu, {\n        testId: testIds.root,\n        ...menu,\n        ref: menuRef,\n        items: menu.items,\n        onItemClick: (itemId, e) => {\n          if (menu.mode !== 'multi-select' && e.detail > 0) {\n            setIsOpen(false);\n          }\n          menu.onItemClick?.(itemId, e);\n        },\n        focusControlEl: buttonRef.current || undefined\n      })\n    })]\n  });\n});\nexport default MenuButton;","map":{"version":3,"names":["forwardRef","useState","useCallback","styled","css","defaultThemeProp","useConsolidatedRef","useUID","useFocusWithin","useDirection","useTestIds","Button","StyledButton","Popover","StyledPopover","Menu","Icon","registerIcon","StyledIcon","arrowMicroDownIcon","Text","StyledText","Flex","Count","getMenuButtonTestIds","StyledMenuButton","button","_ref","theme","base","spacing","defaultProps","StyledMenuButtonChildren","div","_ref2","StyledMenuButtonPopover","MenuButton","props","ref","uid","testId","id","text","menu","popover","onClick","onKeyDown","icon","count","iconOnly","restProps","testIds","isOpen","setIsOpen","buttonRef","popoverRef","menuRef","isFocused","rtl","_jsxs","_Fragment","children","_jsx","root","as","label","undefined","e","clickCount","detail","mode","key","container","alignItems","gap","name","placement","hideOnTargetHidden","show","target","current","items","onItemClick","itemId","focusControlEl"],"sources":["/Users/dasp10/Documents/KT_project/go-mechanic/client/node_modules/@pega/cosmos-react-core/src/components/MenuButton/MenuButton.tsx"],"sourcesContent":["import {\n  forwardRef,\n  useState,\n  FunctionComponent,\n  KeyboardEvent,\n  MouseEventHandler,\n  MouseEvent,\n  UIEvent,\n  PropsWithoutRef,\n  useCallback,\n  KeyboardEventHandler\n} from 'react';\nimport styled, { css } from 'styled-components';\n\nimport type { BaseProps, ForwardProps, NoChildrenProp, OmitStrict, TestIdProp } from '../../types';\nimport { defaultThemeProp } from '../../theme';\nimport { useConsolidatedRef, useUID, useFocusWithin, useDirection, useTestIds } from '../../hooks';\nimport Button, { ButtonProps, StyledButton } from '../Button';\nimport Popover, { PopoverProps, StyledPopover } from '../Popover';\nimport Menu from '../Menu';\nimport { AcceptedMouseEventElement } from '../Menu/Menu.types';\nimport Icon, { registerIcon, StyledIcon } from '../Icon';\nimport * as arrowMicroDownIcon from '../Icon/icons/arrow-micro-down.icon';\nimport Text, { StyledText } from '../Text';\nimport Flex from '../Flex';\nimport { Count } from '../Badges';\nimport type { MenuProps } from '../Menu/Menu.types';\nimport type { CountProps } from '../Badges/Count';\n\nimport { getMenuButtonTestIds } from './MenuButton.test-ids';\n\nregisterIcon(arrowMicroDownIcon);\n\nexport interface MenuButtonProps extends BaseProps, NoChildrenProp, TestIdProp {\n  /** The text for the MenuButton also used to set the aria-label. */\n  text: string;\n  /**\n   * Determines the Button variant for the MenuButton.\n   * @default 'secondary'\n   */\n  variant?: ButtonProps['variant'];\n  /** The name of the icon for the MenuButton. */\n  icon?: string;\n  /** Only display the icon. The text prop will be forwarded to a tooltip. */\n  iconOnly?: ButtonProps['icon'];\n  /** The total count representing the list data which was selected. */\n  count?: CountProps['children'];\n  /** The click handler for the MenuButton. */\n  onClick?: MouseEventHandler;\n  /** Menu related props. */\n  menu?: MenuProps;\n  /** Popover related props. */\n  popover?: OmitStrict<PopoverProps, 'show' | 'target' | 'children'>;\n  /** DOM id for the button element. */\n  id?: string;\n  /** Ref for the button element. */\n  ref?: ButtonProps['ref'];\n  /** The keydown handler for the MenuButton. */\n  onKeyDown?: KeyboardEventHandler;\n}\n\nconst StyledMenuButton = styled.button(\n  ({\n    theme: {\n      base: { spacing }\n    }\n  }) => {\n    return css`\n      gap: ${spacing};\n      flex-shrink: 0;\n      white-space: nowrap;\n      max-width: 100%;\n\n      & + ${StyledPopover} + ${StyledButton} {\n        margin-inline-start: ${spacing};\n      }\n    `;\n  }\n);\n\nStyledMenuButton.defaultProps = defaultThemeProp;\n\nconst StyledMenuButtonChildren = styled.div(({ theme }) => {\n  return css`\n    max-width: 100%;\n\n    ${StyledText} {\n      text-overflow: ellipsis;\n      overflow: hidden;\n    }\n\n    :not(${StyledText}) {\n      flex-shrink: 0;\n    }\n\n    ${StyledIcon}:last-child:not(:first-child) {\n      /* Offsets the flex gap to make the down arrow appear to trail the text. */\n      margin-inline-start: -${theme.base.spacing};\n    }\n  `;\n});\n\nconst StyledMenuButtonPopover = styled(Popover)`\n  min-width: 20ch;\n`;\n\nconst MenuButton: FunctionComponent<ForwardProps & MenuButtonProps> = forwardRef(\n  (props: PropsWithoutRef<MenuButtonProps>, ref: MenuButtonProps['ref']) => {\n    const uid = useUID();\n    const {\n      testId,\n      id = uid,\n      text,\n      menu,\n      popover,\n      onClick,\n      onKeyDown,\n      icon,\n      count,\n      iconOnly = false,\n      ...restProps\n    } = props;\n    const testIds = useTestIds(testId, getMenuButtonTestIds);\n    const [isOpen, setIsOpen] = useState(false);\n\n    const buttonRef = useConsolidatedRef(ref);\n    const popoverRef = useConsolidatedRef<HTMLDivElement>(popover?.ref);\n    const menuRef = useConsolidatedRef<HTMLDivElement>(menu?.ref);\n\n    // FIXME: Type assertion required for issue in useFocusWithin generic\n    useFocusWithin<HTMLElement>(\n      [popoverRef, buttonRef],\n      useCallback(isFocused => {\n        if (!isFocused) setIsOpen(false);\n      }, [])\n    );\n\n    const { rtl } = useDirection();\n\n    return (\n      <>\n        <Button\n          data-testid={testIds.root}\n          as={StyledMenuButton}\n          aria-label={text}\n          {...restProps}\n          id={id}\n          ref={buttonRef}\n          aria-expanded={isOpen}\n          aria-haspopup='menu'\n          aria-controls={`${id}-popover`}\n          label={iconOnly && !isOpen ? text : undefined}\n          onClick={(e: MouseEvent<HTMLButtonElement> & UIEvent<HTMLButtonElement>) => {\n            // clickCount is 0 when triggered by keyboard.\n            const clickCount = e.detail;\n\n            // Close the menu if it is open and either:\n            //   It is a *mouse* click on the button.\n            //   Or, the menu mode is not multiselect.\n            if (isOpen && (clickCount > 0 || menu?.mode !== 'multi-select')) {\n              setIsOpen(false);\n            } else {\n              setIsOpen(true);\n            }\n\n            onClick?.(e);\n          }}\n          onKeyDown={(e: KeyboardEvent) => {\n            if (e.key === 'Escape') setIsOpen(false);\n            onKeyDown?.(e);\n          }}\n          icon={iconOnly}\n        >\n          <Flex as={StyledMenuButtonChildren} container={{ alignItems: 'center', gap: 1 }}>\n            {icon && <Icon name={icon} />}\n            {!iconOnly && (\n              <>\n                {text && <Text>{text}</Text>}\n                {typeof count === 'number' && <Count>{count}</Count>}\n                {text && <Icon name='arrow-micro-down' />}\n              </>\n            )}\n          </Flex>\n        </Button>\n        <StyledMenuButtonPopover\n          placement={rtl ? 'bottom-end' : 'bottom-start'}\n          hideOnTargetHidden\n          {...popover}\n          id={`${id}-popover`}\n          show={!!menu && isOpen}\n          target={buttonRef.current}\n          ref={popoverRef}\n        >\n          {menu && (\n            <Menu\n              testId={testIds.root}\n              {...menu}\n              ref={menuRef}\n              items={menu.items}\n              onItemClick={(itemId, e) => {\n                if (\n                  menu.mode !== 'multi-select' &&\n                  (e as MouseEvent<AcceptedMouseEventElement> & UIEvent<AcceptedMouseEventElement>)\n                    .detail > 0\n                ) {\n                  setIsOpen(false);\n                }\n                menu.onItemClick?.(itemId, e);\n              }}\n              focusControlEl={buttonRef.current || undefined}\n            />\n          )}\n        </StyledMenuButtonPopover>\n      </>\n    );\n  }\n);\n\nexport default MenuButton;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}