{"ast":null,"code":"import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useContext, useRef, useState, useEffect } from 'react';\nimport styled, { css } from 'styled-components';\nimport { defaultThemeProp } from '../../theme';\nimport { hasProp } from '../../utils';\nimport Progress from '../Progress';\nimport { Status } from '../Badges';\nimport { loadMapsAPI, getCoords, toGoogleLatLng, getPlaceById, isLatLngObject } from './utils';\nimport MapsContext from './MapsContext';\nexport const StyledLocationError = styled.div`\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`;\nStyledLocationError.defaultProps = defaultThemeProp;\nexport const StyledLocationView = styled.div(props => {\n  const {\n    height,\n    theme\n  } = props;\n  return css`\n    height: ${height};\n    position: relative;\n    flex: auto;\n    border-radius: ${theme.base['border-radius']};\n    mask-image: radial-gradient(white, black);\n    -webkit-mask-image: radial-gradient(white, black);\n  `;\n});\nStyledLocationView.defaultProps = defaultThemeProp;\nconst StyledMap = styled.div(_ref => {\n  let {\n    height,\n    disabled,\n    status,\n    eMessage,\n    theme: {\n      base: {\n        'disabled-opacity': disabledOpacity\n      }\n    }\n  } = _ref;\n  return css`\n      height: ${height};\n      ${disabled && css`\n        opacity: ${disabledOpacity};\n      `}\n      ${status === 'error' && eMessage && css`\n        opacity: ${disabledOpacity};\n      `}\n    `;\n});\nStyledMap.defaultProps = defaultThemeProp;\nvar LoadStatus;\n(function (LoadStatus) {\n  LoadStatus[\"Init\"] = \"init\";\n  LoadStatus[\"Ready\"] = \"ready\";\n  LoadStatus[\"Error\"] = \"error\";\n})(LoadStatus || (LoadStatus = {}));\nconst hasPlaceId = obj => {\n  return typeof obj === 'object' && obj.placeId && typeof obj.placeId === 'string';\n};\nconst LocationView = props => {\n  const {\n    location = 'current',\n    zoomLevel = 13,\n    height = '25rem',\n    centerMapOnChange = false,\n    onClick,\n    onError,\n    disabled = false,\n    ...restProps\n  } = props;\n  const {\n    name,\n    ...providerOpts\n  } = useContext(MapsContext);\n  const [status, setStatus] = useState(LoadStatus.Init);\n  const [eMessage, setEMessage] = useState('');\n  const mapElemRef = useRef();\n  const map = useRef();\n  const marker = useRef();\n  function initialize() {\n    if (mapElemRef.current) {\n      const position = toGoogleLatLng({\n        latitude: 0,\n        longitude: 0\n      });\n      map.current = new google.maps.Map(mapElemRef.current, {\n        center: position,\n        zoom: 2,\n        draggable: !disabled\n      });\n      marker.current = new google.maps.Marker({\n        map: map.current,\n        position\n      });\n      marker.current?.setVisible(false);\n      if (onClick) map.current.addListener('click', event => {\n        if (event && hasPlaceId(event)) {\n          getPlaceById(event.placeId).then(placeInfo => {\n            if (hasProp(event, 'latLng') && isLatLngObject(event.latLng)) onClick?.({\n              ...placeInfo,\n              latitude: event.latLng.lat(),\n              longitude: event.latLng.lng()\n            });\n          });\n        }\n      });\n    }\n  }\n  useEffect(() => {\n    let unMounted = false;\n    loadMapsAPI(name, providerOpts).then(() => {\n      if (!unMounted) {\n        initialize();\n        setStatus(LoadStatus.Ready);\n      }\n    }).catch(error => {\n      setStatus(LoadStatus.Error);\n      setEMessage(error.message);\n      onError?.(error);\n    });\n    return () => {\n      unMounted = true;\n      if (map.current) google.maps.event.clearInstanceListeners(map.current);\n    };\n  }, []);\n  useEffect(() => {\n    getCoords(location).then(coords => {\n      if (map.current) {\n        map.current.setOptions({\n          zoom: zoomLevel,\n          draggable: !disabled\n        });\n        marker.current?.setPosition(toGoogleLatLng(coords));\n        marker.current?.setVisible(true);\n        if (centerMapOnChange) map.current.setCenter(toGoogleLatLng(coords));\n        if (status !== LoadStatus.Ready) setStatus(LoadStatus.Ready);\n      }\n    }).catch(error => {\n      if (status !== LoadStatus.Error) setStatus(LoadStatus.Error);\n      marker.current?.setVisible(false);\n      setEMessage(error.message);\n      onError?.(error);\n    });\n  }, [location, status, zoomLevel, disabled, centerMapOnChange, onError]);\n  return _jsxs(StyledLocationView, {\n    height: height,\n    children: [_jsx(StyledMap, {\n      ref: mapElemRef,\n      height: height,\n      disabled: disabled,\n      status: status,\n      eMessage: eMessage,\n      ...restProps\n    }), status === LoadStatus.Init && _jsx(Progress, {\n      placement: 'local'\n    }), status === LoadStatus.Error && eMessage && _jsx(Status, {\n      as: StyledLocationError,\n      \"aria-label\": eMessage,\n      variant: 'info',\n      children: eMessage\n    })]\n  });\n};\nexport default LocationView;","map":{"version":3,"names":["useContext","useRef","useState","useEffect","styled","css","defaultThemeProp","hasProp","Progress","Status","loadMapsAPI","getCoords","toGoogleLatLng","getPlaceById","isLatLngObject","MapsContext","StyledLocationError","div","defaultProps","StyledLocationView","props","height","theme","base","StyledMap","_ref","disabled","status","eMessage","disabledOpacity","LoadStatus","hasPlaceId","obj","placeId","LocationView","location","zoomLevel","centerMapOnChange","onClick","onError","restProps","name","providerOpts","setStatus","Init","setEMessage","mapElemRef","map","marker","initialize","current","position","latitude","longitude","google","maps","Map","center","zoom","draggable","Marker","setVisible","addListener","event","then","placeInfo","latLng","lat","lng","unMounted","Ready","catch","error","Error","message","clearInstanceListeners","coords","setOptions","setPosition","setCenter","_jsxs","children","_jsx","ref","placement","as","variant"],"sources":["/Users/dasp10/Documents/KT_project/go-mechanic/client/node_modules/@pega/cosmos-react-core/src/components/Location/LocationView.tsx"],"sourcesContent":["import { FC, useContext, useRef, useState, useEffect, Ref } from 'react';\nimport styled, { css } from 'styled-components';\n\nimport { BaseProps } from '../../types';\nimport { defaultThemeProp } from '../../theme';\nimport { hasProp } from '../../utils';\nimport Progress from '../Progress';\nimport { Status } from '../Badges';\n\nimport { LatLng } from './types';\nimport { loadMapsAPI, getCoords, toGoogleLatLng, getPlaceById, isLatLngObject } from './utils';\nimport BaseLocationProps from './Location.types';\nimport MapsContext from './MapsContext';\n\nexport const StyledLocationError = styled.div`\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nStyledLocationError.defaultProps = defaultThemeProp;\n\nexport const StyledLocationView = styled.div<{ height?: string }>(props => {\n  const { height, theme } = props;\n\n  return css`\n    height: ${height};\n    position: relative;\n    flex: auto;\n    border-radius: ${theme.base['border-radius']};\n    mask-image: radial-gradient(white, black);\n    -webkit-mask-image: radial-gradient(white, black);\n  `;\n});\n\nStyledLocationView.defaultProps = defaultThemeProp;\n\nconst StyledMap = styled.div<{\n  height?: string;\n  status: string;\n  disabled: boolean;\n  eMessage: string;\n}>(\n  ({\n    height,\n    disabled,\n    status,\n    eMessage,\n    theme: {\n      base: { 'disabled-opacity': disabledOpacity }\n    }\n  }) => {\n    return css`\n      height: ${height};\n      ${disabled &&\n      css`\n        opacity: ${disabledOpacity};\n      `}\n      ${status === 'error' &&\n      eMessage &&\n      css`\n        opacity: ${disabledOpacity};\n      `}\n    `;\n  }\n);\n\nStyledMap.defaultProps = defaultThemeProp;\n\nexport interface LocationViewProps extends BaseLocationProps, BaseProps {\n  /**\n   * Location string as either coordinates, name of a place, or 'current' for the current location.\n   * @default 'current'\n   */\n  location?: LatLng | string | 'current';\n  /**\n   * Set to true to always center the map when the selected location changes. Toggling this from false to true will re-center map on the last pinned location.\n   * @default false\n   */\n  centerMapOnChange?: boolean;\n  /**\n   * Height of the map container.\n   * @default '25rem'\n   */\n  height?: string;\n  /**\n   * How much the map should zoom.\n   * @default 13\n   */\n  zoomLevel?: number;\n  /** Callback fired when user clicks on a location on the map. This function will be passed the coordinates of the location that was clicked. */\n  onClick?: (coords: {\n    latitude: number;\n    longitude: number;\n    name?: string;\n    address?: string;\n  }) => void;\n}\n\nenum LoadStatus {\n  Init = 'init',\n  Ready = 'ready',\n  Error = 'error'\n}\n\nconst hasPlaceId = (obj: any): obj is google.maps.IconMouseEvent & { placeId: string } => {\n  return typeof obj === 'object' && obj.placeId && typeof obj.placeId === 'string';\n};\n\nconst LocationView: FC<LocationViewProps> = (props: LocationViewProps) => {\n  const {\n    location = 'current',\n    zoomLevel = 13,\n    height = '25rem',\n    centerMapOnChange = false,\n    onClick,\n    onError,\n    disabled = false,\n    ...restProps\n  } = props;\n  const { name, ...providerOpts } = useContext(MapsContext);\n  const [status, setStatus] = useState<LoadStatus>(LoadStatus.Init);\n  const [eMessage, setEMessage] = useState('');\n  const mapElemRef = useRef<HTMLDivElement>();\n  const map = useRef<google.maps.Map>();\n  const marker = useRef<google.maps.Marker>();\n\n  function initialize(): void {\n    if (mapElemRef.current) {\n      const position = toGoogleLatLng({ latitude: 0, longitude: 0 });\n      map.current = new google.maps.Map(mapElemRef.current, {\n        center: position,\n        zoom: 2,\n        draggable: !disabled\n      });\n      marker.current = new google.maps.Marker({\n        map: map.current,\n        position\n      });\n      marker.current?.setVisible(false);\n      if (onClick)\n        map.current.addListener('click', (event: unknown) => {\n          if (event && hasPlaceId(event)) {\n            getPlaceById(event.placeId).then(placeInfo => {\n              if (hasProp(event, 'latLng') && isLatLngObject(event.latLng))\n                onClick?.({\n                  ...placeInfo,\n                  latitude: event.latLng.lat(),\n                  longitude: event.latLng.lng()\n                });\n            });\n          }\n        });\n    }\n  }\n\n  useEffect(() => {\n    let unMounted = false;\n    loadMapsAPI(name, providerOpts)\n      .then(() => {\n        if (!unMounted) {\n          initialize();\n          setStatus(LoadStatus.Ready);\n        }\n      })\n      .catch((error: Error) => {\n        setStatus(LoadStatus.Error);\n        setEMessage(error.message);\n        onError?.(error);\n      });\n\n    return () => {\n      unMounted = true;\n      if (map.current) google.maps.event.clearInstanceListeners(map.current);\n    };\n  }, []);\n\n  useEffect(() => {\n    getCoords(location!)\n      .then(coords => {\n        if (map.current) {\n          map.current.setOptions({\n            zoom: zoomLevel,\n            draggable: !disabled\n          });\n          marker.current?.setPosition(toGoogleLatLng(coords));\n          marker.current?.setVisible(true);\n          if (centerMapOnChange) map.current.setCenter(toGoogleLatLng(coords));\n          if (status !== LoadStatus.Ready) setStatus(LoadStatus.Ready);\n        }\n      })\n      .catch((error: Error) => {\n        if (status !== LoadStatus.Error) setStatus(LoadStatus.Error);\n        marker.current?.setVisible(false);\n        setEMessage(error.message);\n        onError?.(error);\n      });\n  }, [location, status, zoomLevel, disabled, centerMapOnChange, onError]);\n\n  return (\n    <StyledLocationView height={height}>\n      <StyledMap\n        ref={mapElemRef as Ref<HTMLDivElement>}\n        height={height}\n        disabled={disabled}\n        status={status}\n        eMessage={eMessage}\n        {...restProps}\n      />\n      {status === LoadStatus.Init && <Progress placement='local' />}\n      {status === LoadStatus.Error && eMessage && (\n        <Status as={StyledLocationError} aria-label={eMessage} variant='info'>\n          {eMessage}\n        </Status>\n      )}\n    </StyledLocationView>\n  );\n};\n\nexport default LocationView;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}