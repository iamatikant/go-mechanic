{"ast":null,"code":"import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { forwardRef, useEffect, useRef, useState } from 'react';\nimport Icon, { registerIcon } from '../Icon';\nimport * as caretDownIcon from '../Icon/icons/caret-down.icon';\nimport * as timesIcon from '../Icon/icons/times.icon';\nimport { useConsolidatedRef, useElement, useEscape, useI18n, useOuterEvent, useTestIds, useUID } from '../../hooks';\nimport { StyledFormControl } from '../FormControl';\nimport { getFocusables } from '../../utils';\nimport Flex from '../Flex';\nimport Button from '../Button';\nimport FormField from '../FormField';\nimport { FormDialog } from '../Dialog';\nimport { StyledCompositeInput, StyledInputButton, StyledInputContainer } from './CompositeInput.styles';\nimport { getCompositeInputTestIds } from './CompositeInput.test-ids';\nregisterIcon(caretDownIcon, timesIcon);\nconst CompositeInput = forwardRef((props, ref) => {\n  const uid = useUID();\n  const {\n    testId,\n    id = uid,\n    disabled,\n    value,\n    onClear,\n    required,\n    status,\n    info,\n    label,\n    labelHidden,\n    additionalInfo,\n    dialog: {\n      renderer: Renderer,\n      rendererProps,\n      onApply,\n      onCancel\n    },\n    ...restProps\n  } = props;\n  const testIds = useTestIds(testId, getCompositeInputTestIds);\n  const t = useI18n();\n  const [open, setOpen] = useState(false);\n  const [popoverEl, setPopoverEl] = useElement(null);\n  const containerRef = useConsolidatedRef(ref);\n  const buttonRef = useRef(null);\n  const formContentRef = useRef(null);\n  const closePopover = () => {\n    setOpen(false);\n    buttonRef.current?.focus();\n  };\n  useOuterEvent('mousedown', [popoverEl, buttonRef], () => {\n    if (open) onCancel({\n      close: closePopover\n    });\n  });\n  useEffect(() => {\n    if (open) {\n      getFocusables(formContentRef)[0]?.focus();\n    }\n  }, [open, formContentRef.current]);\n  useEscape(e => {\n    e.preventDefault();\n    closePopover();\n  }, document, [closePopover]);\n  const labelId = `${id}-label`;\n  const Comp = _jsxs(Flex, {\n    as: StyledCompositeInput,\n    forwardedAs: StyledFormControl,\n    container: {\n      alignItems: 'center'\n    },\n    status: status,\n    disabled: disabled,\n    ref: containerRef,\n    children: [_jsxs(Flex, {\n      container: {\n        alignItems: 'center'\n      },\n      item: {\n        grow: 1\n      },\n      as: StyledInputContainer,\n      children: [_jsx(StyledInputButton, {\n        \"data-testid\": testIds.control,\n        ...restProps,\n        id: id,\n        disabled: disabled,\n        \"aria-haspopup\": 'dialog',\n        \"aria-expanded\": !disabled && open,\n        \"aria-describedby\": info ? `${id}-info` : undefined,\n        readOnly: true,\n        required: required,\n        onClick: () => {\n          if (!disabled) {\n            setOpen(true);\n          }\n        },\n        onKeyDown: e => {\n          if (e.key === 'Enter') {\n            e.preventDefault();\n            setOpen(true);\n          }\n        },\n        value: value ?? '',\n        ref: buttonRef\n      }), _jsx(Flex, {\n        container: {\n          justify: 'center',\n          alignItems: 'center'\n        },\n        style: {\n          pointerEvents: value ? '' : 'none'\n        },\n        children: value && !open ? _jsx(Button, {\n          icon: true,\n          compact: true,\n          variant: 'simple',\n          label: t('clear'),\n          onClick: onClear,\n          children: _jsx(Icon, {\n            name: 'times'\n          })\n        }) : _jsx(Icon, {\n          name: 'caret-down'\n        })\n      })]\n    }), open && containerRef.current && _jsx(FormDialog, {\n      arrow: false,\n      // FIXME: The wrath of optional labels, as a ReactNode, strikes again...\n      ariaLabel: label,\n      ref: setPopoverEl,\n      target: containerRef.current,\n      placement: 'bottom-start',\n      onCancel: () => onCancel({\n        close: closePopover\n      }),\n      onSubmit: {\n        text: t('apply'),\n        handler: () => onApply({\n          close: closePopover\n        })\n      },\n      children: _jsx(Flex, {\n        container: {\n          direction: 'column'\n        },\n        ref: formContentRef,\n        children: _jsx(Renderer, {\n          ...rendererProps\n        })\n      })\n    })]\n  });\n  return label ? _jsx(FormField, {\n    ...{\n      testId: testIds,\n      label,\n      labelHidden,\n      id,\n      info,\n      status,\n      required,\n      disabled,\n      labelId,\n      additionalInfo\n    },\n    children: Comp\n  }) : Comp;\n});\nexport default CompositeInput;","map":{"version":3,"names":["forwardRef","useEffect","useRef","useState","Icon","registerIcon","caretDownIcon","timesIcon","useConsolidatedRef","useElement","useEscape","useI18n","useOuterEvent","useTestIds","useUID","StyledFormControl","getFocusables","Flex","Button","FormField","FormDialog","StyledCompositeInput","StyledInputButton","StyledInputContainer","getCompositeInputTestIds","CompositeInput","props","ref","uid","testId","id","disabled","value","onClear","required","status","info","label","labelHidden","additionalInfo","dialog","renderer","Renderer","rendererProps","onApply","onCancel","restProps","testIds","t","open","setOpen","popoverEl","setPopoverEl","containerRef","buttonRef","formContentRef","closePopover","current","focus","close","e","preventDefault","document","labelId","Comp","_jsxs","as","forwardedAs","container","alignItems","children","item","grow","_jsx","control","undefined","readOnly","onClick","onKeyDown","key","justify","style","pointerEvents","icon","compact","variant","name","arrow","ariaLabel","target","placement","onSubmit","text","handler","direction"],"sources":["/Users/dasp10/Documents/KT_project/go-mechanic/client/node_modules/@pega/cosmos-react-core/src/components/CompositeInput/CompositeInput.tsx"],"sourcesContent":["import { forwardRef, PropsWithoutRef, useEffect, useRef, useState } from 'react';\n\nimport Icon, { registerIcon } from '../Icon';\nimport * as caretDownIcon from '../Icon/icons/caret-down.icon';\nimport * as timesIcon from '../Icon/icons/times.icon';\nimport { ForwardProps } from '../../types';\nimport {\n  useConsolidatedRef,\n  useElement,\n  useEscape,\n  useI18n,\n  useOuterEvent,\n  useTestIds,\n  useUID\n} from '../../hooks';\nimport { StyledFormControl } from '../FormControl';\nimport { getFocusables } from '../../utils';\nimport Flex from '../Flex';\nimport Button from '../Button';\nimport FormField from '../FormField';\nimport { FormDialog } from '../Dialog';\n\nimport {\n  StyledCompositeInput,\n  StyledInputButton,\n  StyledInputContainer\n} from './CompositeInput.styles';\nimport { CompositeInputProps } from './CompositeInput.types';\nimport { getCompositeInputTestIds } from './CompositeInput.test-ids';\n\nregisterIcon(caretDownIcon, timesIcon);\n\nconst CompositeInput = forwardRef(\n  (props: PropsWithoutRef<CompositeInputProps>, ref: CompositeInputProps['ref']) => {\n    const uid = useUID();\n    const {\n      testId,\n      id = uid,\n      disabled,\n      value,\n      onClear,\n      required,\n      status,\n      info,\n      label,\n      labelHidden,\n      additionalInfo,\n      dialog: { renderer: Renderer, rendererProps, onApply, onCancel },\n      ...restProps\n    } = props;\n\n    const testIds = useTestIds(testId, getCompositeInputTestIds);\n    const t = useI18n();\n\n    const [open, setOpen] = useState(false);\n\n    const [popoverEl, setPopoverEl] = useElement<HTMLElement>(null);\n    const containerRef = useConsolidatedRef<HTMLDivElement>(ref);\n    const buttonRef = useRef<HTMLInputElement>(null);\n    const formContentRef = useRef<HTMLElement>(null);\n\n    const closePopover = () => {\n      setOpen(false);\n      buttonRef.current?.focus();\n    };\n\n    useOuterEvent('mousedown', [popoverEl, buttonRef], () => {\n      if (open) onCancel({ close: closePopover });\n    });\n\n    useEffect(() => {\n      if (open) {\n        getFocusables(formContentRef)[0]?.focus();\n      }\n    }, [open, formContentRef.current]);\n\n    useEscape(\n      e => {\n        e.preventDefault();\n        closePopover();\n      },\n      document,\n      [closePopover]\n    );\n\n    const labelId = `${id}-label`;\n\n    const Comp = (\n      <Flex\n        as={StyledCompositeInput}\n        forwardedAs={StyledFormControl}\n        container={{ alignItems: 'center' }}\n        status={status}\n        disabled={disabled}\n        ref={containerRef}\n      >\n        <Flex container={{ alignItems: 'center' }} item={{ grow: 1 }} as={StyledInputContainer}>\n          <StyledInputButton\n            data-testid={testIds.control}\n            {...restProps}\n            id={id}\n            disabled={disabled}\n            aria-haspopup='dialog'\n            aria-expanded={!disabled && open}\n            aria-describedby={info ? `${id}-info` : undefined}\n            readOnly\n            required={required}\n            onClick={() => {\n              if (!disabled) {\n                setOpen(true);\n              }\n            }}\n            onKeyDown={e => {\n              if (e.key === 'Enter') {\n                e.preventDefault();\n                setOpen(true);\n              }\n            }}\n            value={value ?? ''}\n            ref={buttonRef}\n          />\n          <Flex\n            container={{ justify: 'center', alignItems: 'center' }}\n            style={{ pointerEvents: value ? '' : 'none' }}\n          >\n            {value && !open ? (\n              <Button icon compact variant='simple' label={t('clear')} onClick={onClear}>\n                <Icon name='times' />\n              </Button>\n            ) : (\n              <Icon name='caret-down' />\n            )}\n          </Flex>\n        </Flex>\n\n        {open && containerRef.current && (\n          <FormDialog\n            arrow={false}\n            // FIXME: The wrath of optional labels, as a ReactNode, strikes again...\n            ariaLabel={label as string}\n            ref={setPopoverEl}\n            target={containerRef.current}\n            placement='bottom-start'\n            onCancel={() => onCancel({ close: closePopover })}\n            onSubmit={{\n              text: t('apply'),\n              handler: () => onApply({ close: closePopover })\n            }}\n          >\n            <Flex container={{ direction: 'column' }} ref={formContentRef}>\n              <Renderer {...rendererProps} />\n            </Flex>\n          </FormDialog>\n        )}\n      </Flex>\n    );\n\n    return label ? (\n      <FormField\n        {...{\n          testId: testIds,\n          label,\n          labelHidden,\n          id,\n          info,\n          status,\n          required,\n          disabled,\n          labelId,\n          additionalInfo\n        }}\n      >\n        {Comp}\n      </FormField>\n    ) : (\n      Comp\n    );\n  }\n) as <P extends object>(props: CompositeInputProps<P> & ForwardProps) => JSX.Element | null;\n\nexport default CompositeInput;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}