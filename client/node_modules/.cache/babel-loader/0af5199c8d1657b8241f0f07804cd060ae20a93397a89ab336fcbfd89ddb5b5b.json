{"ast":null,"code":"import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useCallback, useContext, useEffect, useState } from 'react';\nimport styled, { css } from 'styled-components';\nimport Tooltip from '../Tooltip';\nimport { useElement, useI18n } from '../../hooks';\nimport Icon, { registerIcon } from '../Icon';\nimport * as locationIcon from '../Icon/icons/location.icon';\nimport Button from '../Button';\nimport { defaultThemeProp } from '../../theme';\nimport MapsContext from './MapsContext';\nimport { getNavigatorPosition, getAddress, loadMapsAPI } from './utils';\nregisterIcon(locationIcon);\nexport const StyledCurrentLocationButton = styled(Button)(_ref => {\n  let {\n    currentLocationDisabled,\n    theme: {\n      base: {\n        'disabled-opacity': disabledOpacity\n      }\n    }\n  } = _ref;\n  return css`\n    ${currentLocationDisabled && css`\n      opacity: ${disabledOpacity};\n      cursor: auto;\n    `}\n  `;\n});\nStyledCurrentLocationButton.defaultProps = defaultThemeProp;\nconst CurrentLocationButton = _ref2 => {\n  let {\n    onChange,\n    onError,\n    defaultToCurrentLocation\n  } = _ref2;\n  const t = useI18n();\n  const {\n    name,\n    ...providerOpts\n  } = useContext(MapsContext);\n  const [currentLocationDisabled, setCurrentLocationDisabled] = useState(false);\n  const [el, setEl] = useElement();\n  const getCurrentLocation = useCallback(() => {\n    getNavigatorPosition().catch(error => {\n      setCurrentLocationDisabled(true);\n      throw error;\n    }).then(getAddress).then(address => onChange?.(address)).catch(error => onError?.(error));\n  }, [onChange, onError]);\n  useEffect(() => {\n    navigator.permissions?.query({\n      name: 'geolocation'\n    }).then(result => {\n      if (result.state === 'denied') {\n        setCurrentLocationDisabled(true);\n      }\n    });\n    if (defaultToCurrentLocation) {\n      loadMapsAPI(name, providerOpts).then(getCurrentLocation);\n    }\n  }, []);\n  return _jsxs(_Fragment, {\n    children: [_jsx(Button, {\n      ref: setEl,\n      as: StyledCurrentLocationButton,\n      variant: 'simple',\n      icon: true,\n      onClick: getCurrentLocation,\n      \"aria-label\": t('my_current_location_button_a11y'),\n      currentLocationDisabled: currentLocationDisabled,\n      children: _jsx(Icon, {\n        name: 'location'\n      })\n    }), el && currentLocationDisabled && _jsx(Tooltip, {\n      shown: true,\n      target: el,\n      children: t('allow_location_permissions_text')\n    })]\n  });\n};\nexport default CurrentLocationButton;","map":{"version":3,"names":["useCallback","useContext","useEffect","useState","styled","css","Tooltip","useElement","useI18n","Icon","registerIcon","locationIcon","Button","defaultThemeProp","MapsContext","getNavigatorPosition","getAddress","loadMapsAPI","StyledCurrentLocationButton","_ref","currentLocationDisabled","theme","base","disabledOpacity","defaultProps","CurrentLocationButton","_ref2","onChange","onError","defaultToCurrentLocation","t","name","providerOpts","setCurrentLocationDisabled","el","setEl","getCurrentLocation","catch","error","then","address","navigator","permissions","query","result","state","_jsxs","_Fragment","children","_jsx","ref","as","variant","icon","onClick","shown","target"],"sources":["/Users/dasp10/Documents/KT_project/go-mechanic/client/node_modules/@pega/cosmos-react-core/src/components/Location/CurrentLocationButton.tsx"],"sourcesContent":["import { FC, useCallback, useContext, useEffect, useState } from 'react';\nimport styled, { css } from 'styled-components';\n\nimport Tooltip from '../Tooltip';\nimport { useElement, useI18n } from '../../hooks';\nimport Icon, { registerIcon } from '../Icon';\nimport * as locationIcon from '../Icon/icons/location.icon';\nimport Button from '../Button';\nimport { defaultThemeProp } from '../../theme';\n\nimport MapsContext from './MapsContext';\nimport { getNavigatorPosition, getAddress, loadMapsAPI } from './utils';\n\nregisterIcon(locationIcon);\n\nexport type CurrentLocationButtonProps = {\n  /** Callback fired after click on my current location button if location was found. */\n  onChange?: (value: {\n    name: string;\n    address?: string;\n    latitude?: number;\n    longitude?: number;\n  }) => void;\n  /** Callback fired when an error occurs. */\n  onError?: (error: Error) => void;\n  /** Get current location on component first render */\n  defaultToCurrentLocation?: boolean;\n};\n\nexport const StyledCurrentLocationButton = styled(Button)<{ currentLocationDisabled: boolean }>(\n  ({\n    currentLocationDisabled,\n    theme: {\n      base: { 'disabled-opacity': disabledOpacity }\n    }\n  }) => css`\n    ${currentLocationDisabled &&\n    css`\n      opacity: ${disabledOpacity};\n      cursor: auto;\n    `}\n  `\n);\n\nStyledCurrentLocationButton.defaultProps = defaultThemeProp;\n\nconst CurrentLocationButton: FC<CurrentLocationButtonProps> = ({\n  onChange,\n  onError,\n  defaultToCurrentLocation\n}: CurrentLocationButtonProps) => {\n  const t = useI18n();\n  const { name, ...providerOpts } = useContext(MapsContext);\n  const [currentLocationDisabled, setCurrentLocationDisabled] = useState(false);\n  const [el, setEl] = useElement();\n\n  const getCurrentLocation = useCallback(() => {\n    getNavigatorPosition()\n      .catch(error => {\n        setCurrentLocationDisabled(true);\n        throw error;\n      })\n      .then(getAddress)\n      .then(address => onChange?.(address))\n      .catch(error => onError?.(error));\n  }, [onChange, onError]);\n\n  useEffect(() => {\n    navigator.permissions?.query({ name: 'geolocation' }).then(result => {\n      if (result.state === 'denied') {\n        setCurrentLocationDisabled(true);\n      }\n    });\n    if (defaultToCurrentLocation) {\n      loadMapsAPI(name, providerOpts).then(getCurrentLocation);\n    }\n  }, []);\n\n  return (\n    <>\n      <Button\n        ref={setEl}\n        as={StyledCurrentLocationButton}\n        variant='simple'\n        icon\n        onClick={getCurrentLocation}\n        aria-label={t('my_current_location_button_a11y')}\n        currentLocationDisabled={currentLocationDisabled}\n      >\n        <Icon name='location' />\n      </Button>\n      {el && currentLocationDisabled && (\n        <Tooltip shown target={el}>\n          {t('allow_location_permissions_text')}\n        </Tooltip>\n      )}\n    </>\n  );\n};\nexport default CurrentLocationButton;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}